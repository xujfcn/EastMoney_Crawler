# 东方财富爬虫项目

## 📋 项目概述

本项目是一个用于爬取东方财富网股吧论坛数据的爬虫工具，支持获取指定股票的帖子信息和评论数据。

## 🚀 核心功能

- **股票帖子爬取**: 获取指定股票代码的论坛帖子列表
- **评论数据提取**: 爬取帖子的评论和回复信息
- **数据存储**: 支持MongoDB数据库和JSON文件存储
- **反检测机制**: 使用Selenium和Playwright进行浏览器自动化

## 📁 项目结构

### 核心文件
- `main.py` - 原始Selenium版本的主程序入口
- `crawler.py` - Selenium爬虫核心逻辑
- `parser.py` - 数据解析模块
- `mongodb.py` - MongoDB数据库操作
- `stealth.min.js` - 浏览器反检测脚本

### 推荐使用
- `playwright_eastmoney_crawler.py` - **推荐使用的Playwright版本**
- `playwright_crawler.log` - Playwright爬虫运行日志
- `playwright_posts_002001_*.json` - 爬取的帖子数据
- `playwright_comments_002001_*.json` - 爬取的评论数据

### 配置文件
- `requirements.txt` - Python依赖包列表
- `README.md` - 项目说明文档
- `使用说明.md` - 详细使用指南
- `项目总结.md` - 项目技术总结

## 🛠️ 环境要求

### Python依赖
```bash
pip install selenium>=4.0.0
pip install pymongo>=4.0.0
pip install pandas>=1.3.0
pip install webdriver-manager>=3.8.0
pip install playwright>=1.40.0
```

### 浏览器驱动
```bash
# 安装Playwright浏览器
playwright install
```

### 数据库（可选）
- MongoDB（如需使用数据库存储）

## 📖 使用方法

### 方法一：Playwright版本（推荐）
```bash
# 激活虚拟环境
conda activate qlib

# 运行Playwright爬虫
python playwright_eastmoney_crawler.py
```

### 方法二：Selenium版本
```bash
# 激活虚拟环境
conda activate qlib

# 运行Selenium爬虫
python main.py
```

## 📊 输出数据格式

### 帖子数据结构
```json
{
  "title": "帖子标题",
  "author": "作者用户名",
  "post_time": "发布时间",
  "read_count": "阅读数",
  "reply_count": "回复数",
  "post_url": "帖子链接",
  "stock_code": "股票代码",
  "stock_name": "股票名称",
  "crawl_time": "爬取时间"
}
```

### 评论数据结构
```json
{
  "author": "评论作者",
  "content": "评论内容",
  "comment_time": "评论时间",
  "floor_number": "楼层号",
  "post_url": "所属帖子链接",
  "stock_code": "股票代码",
  "crawl_time": "爬取时间"
}
```

## ⚡ 性能对比

| 版本 | 稳定性 | 性能 | 反检测 | 推荐度 |
|------|--------|------|--------|--------|
| Playwright | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ✅ 推荐 |
| Selenium | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⚠️ 备用 |

## 🔧 技术特点

### Playwright版本优势
- **高性能**: 原生异步支持，执行效率高
- **稳定性强**: 更好的页面等待和错误处理机制
- **兼容性好**: 避免了第三方库的兼容性问题
- **易维护**: 代码结构清晰，便于扩展

### Selenium版本优势
- **反检测强**: 集成stealth.min.js反检测脚本
- **成熟稳定**: 经过长期验证的爬虫方案
- **功能完整**: 支持MongoDB存储和多线程爬取

## 📝 使用示例

### 爬取新和成(002001)股票数据
```python
# 使用Playwright版本
crawler = PlaywrightEastMoneyCrawler(
    stock_code="002001", 
    stock_name="新和成"
)
await crawler.run()
```

### 自定义股票代码
```python
# 修改stock_code和stock_name参数
crawler = PlaywrightEastMoneyCrawler(
    stock_code="000001", 
    stock_name="平安银行"
)
```

## 🚨 注意事项

1. **合规使用**: 请遵守网站robots.txt和使用条款
2. **频率控制**: 建议设置合理的爬取间隔，避免对服务器造成压力
3. **数据用途**: 仅用于学习研究，不得用于商业用途
4. **环境配置**: 确保Python环境和浏览器驱动正确安装

## 📞 技术支持

如遇到问题，请检查：
1. Python依赖是否完整安装
2. 浏览器驱动是否正确配置
3. 网络连接是否正常
4. 目标网站是否可正常访问

## 📈 项目历程

- **v1.0**: 基础Selenium爬虫实现
- **v2.0**: 增加MongoDB存储支持
- **v3.0**: 添加Playwright高性能版本
- **v4.0**: 项目清理和文档完善

---

**推荐使用Playwright版本获得最佳性能和稳定性！**